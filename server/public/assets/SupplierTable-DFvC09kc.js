import{u as U,r as t,E as _,F as G,H as I,J as $,j as e}from"./index-Cl1SQMCp.js";import{t as i}from"./index-MnOYjBE-.js";import{L as z}from"./Loader-BikfMRdt.js";import{T as M}from"./TableData-CyOfLgzd.js";import{T as j}from"./toast-DZZ6LTTs.js";import{u as H}from"./useDebounce-CfTSEcaX.js";import{B as J}from"./briefcase-ChOFTStc.js";import"./index-BPJnJB5S.js";import"./CustomerHistory-BGs4THpq.js";import"./card-mR9xUq05.js";import"./badge-Duqbj1_E.js";import"./emailSendReceipt.api-LrsuY_7X.js";import"./label-DJCwXsjE.js";import"./zod-Cx2om5l9.js";import"./InstallmentAccordion-D9aMCyou.js";import"./index-7vMckiJz.js";import"./chevron-down-CZWChAHx.js";import"./index-zu5Pjoey.js";const ue=()=>{var b;const u=U(),[l,y]=t.useState(""),k=H(l,500),[o,v]=t.useState({pageIndex:0,pageSize:10}),[E,N]=t.useState([]),{data:r,isLoading:B,isSuccess:p,refetch:d}=_({searchQuery:k.toLowerCase(),page:o.pageIndex+1,limit:o.pageSize}),[D,{isSuccess:m,isError:g,isLoading:x}]=G(),[C,{isSuccess:f,isError:h,isLoading:S}]=I(),[L,{data:c,error:w,isSuccess:F,isError:P}]=$(),T=()=>{p&&N(r.result)},A=async s=>{await C(s),d()},Q=async(s,a)=>{console.log("currentBlockStatus:",a);try{await D(s),await d()}catch(n){console.error("Failed to toggle supplier block status",n)}},K=[{accessorKey:"name",header:"Supplier Name"},{accessorKey:"mobile",header:"Phone Number"},{accessorKey:"address",header:"Address"},{accessorKey:"status",header:"Status",cell:({row:s})=>{const a=s.original.status,n=()=>{L({id:s.original._id,status:a==="active"?"inactive":"active"})};return e.jsx("span",{onClick:n,className:`cursor-pointer px-3 py-1 rounded-full text-sm font-semibold ${a==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a==="active"?"Active":"Inactive"})}},{header:"Actions",cell:({row:s})=>{const a=s.original.isBlock;return e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>u(`/admin/supplier-page/${s.original._id}`),className:"text-blue-600",children:"Edit"}),e.jsx("button",{onClick:()=>A(s.original._id),className:"text-red-600",children:"Delete"}),e.jsx("button",{onClick:()=>Q(s.original._id,a),className:`font-medium ${a?"text-green-600":"text-yellow-600"}`,children:a?"Unblock":"Block"})]})}}];return t.useEffect(()=>{T()},[p,r]),B?e.jsx(z,{}):(t.useEffect(()=>{m&&i.success("Supplier blocked successfully")},[m]),t.useEffect(()=>{g&&i.error("Failed to block supplier")},[g]),t.useEffect(()=>{x&&i.info("Blocking supplier...")},[x]),t.useEffect(()=>{f&&i.success("Supplier deleted successfully")},[f]),t.useEffect(()=>{h&&i.error("Failed to delete supplier")},[h]),t.useEffect(()=>{S&&i.info("Deleting supplier...")},[S]),e.jsxs(e.Fragment,{children:[F&&e.jsx(j,{type:"success",message:c==null?void 0:c.message}),P&&e.jsx(j,{type:"error",message:w}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mt-5",children:[e.jsx(J,{className:"h-6 w-6 text-blue-600"}),e.jsx("h2",{className:"text-lg font-bold",children:"Suppliers"})]}),e.jsxs("div",{className:"flex gap-2 mt-5",children:[e.jsx("input",{type:"text",placeholder:"Search...",value:l,onChange:s=>y(s.target.value),className:"border px-3 py-1 rounded-md"}),e.jsx("button",{onClick:()=>u("/admin/supplier-page"),className:"bg-indigo-600 text-white px-4 py-2 rounded-md",children:"Add"})]})]}),e.jsx("div",{className:"mt-8 flow-root",children:e.jsx("div",{className:"overflow-x-auto sm:-mx-6 lg:-mx-8",children:e.jsx("div",{className:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8",children:e.jsx(M,{data:E,columns:K,enableSorting:!0,onPaginationChange:v,enableGlobalFilter:!0,onGlobalFilterChange:l,initialPagination:o,totalPages:(b=r==null?void 0:r.pagination)==null?void 0:b.totalPages})})})})]}))};export{ue as default};
