import{u as K,r as l,O as V,P as w,Q as B,R as E,j as t,T as A}from"./index-Cl1SQMCp.js";import{t as r}from"./index-MnOYjBE-.js";import{T as Q}from"./TableData-CyOfLgzd.js";import{L}from"./Loader-BikfMRdt.js";import"./CustomerHistory-BGs4THpq.js";import"./card-mR9xUq05.js";import"./badge-Duqbj1_E.js";import"./emailSendReceipt.api-LrsuY_7X.js";import"./label-DJCwXsjE.js";import"./zod-Cx2om5l9.js";import"./InstallmentAccordion-D9aMCyou.js";import"./index-7vMckiJz.js";import"./chevron-down-CZWChAHx.js";import"./index-BPJnJB5S.js";const W=()=>{var p;const i=K(),[o,m]=l.useState(""),[n,g]=l.useState({pageIndex:0,pageSize:10}),[x,h]=l.useState([]),{data:c,isLoading:y,isSuccess:d,refetch:u}=V({searchQuery:o.toLowerCase(),page:n.pageIndex+1,limit:n.pageSize}),[b]=w(),[j]=B(),[P,{isSuccess:f,isError:S,error:N}]=E(),k=async()=>{d&&h((c==null?void 0:c.result)||[])},v=async e=>{await b(e),r.success("Product deleted"),await u()},D=async(e,a)=>{try{const s=await j(e);console.log("response::",s),r.success(a?"Product unblocked":"Product blocked"),await u()}catch{r.error("Block/unblock failed")}},C=[{accessorKey:"name",header:()=>t.jsx("span",{title:"Product Name",children:"P.Name"}),cell:e=>e.getValue()},{header:"Supplier",cell:({row:e})=>{var a;return typeof e.original.supplier=="object"?((a=e.original.supplier)==null?void 0:a.name)??"N/A":"N/A"}},{header:"Company",cell:({row:e})=>{var a;return typeof e.original.company=="object"?((a=e.original.company)==null?void 0:a.name)??"N/A":"N/A"}},{accessorKey:"category",header:"Category",cell:e=>e.getValue()},{accessorKey:"price",header:"Price",cell:e=>`â‚¹${e.getValue()}`},{accessorKey:"stock",header:"Stock",cell:e=>e.getValue()},{accessorKey:"soldQuantity",header:()=>t.jsx("span",{title:"Sold Quantity",children:"SQ"}),cell:e=>e.getValue()},{accessorKey:"remainingStock",header:()=>t.jsx("span",{title:"Remaining Stock",children:"R.Stock"}),cell:e=>{const a=e.getValue(),s=a<=10;return t.jsx("span",{className:`font-bold px-2 py-1 rounded-md ${s?"bg-red-100 text-red-700 animate-pulse":"text-gray-350"}`,children:a})}},{accessorKey:"batchNumber",header:()=>t.jsx("span",{title:"Batch Number",children:"Batch"}),cell:e=>e.getValue()},{accessorKey:"sellingPrice",header:()=>t.jsx("span",{title:"Selling Price",children:"S.Price"}),cell:e=>e.getValue()},{accessorKey:"mrp",header:"MRP",cell:e=>e.getValue()},{accessorKey:"manufactureDate",header:()=>t.jsx("span",{title:"Manufacture Date",children:"MFD"}),cell:e=>{const a=e.getValue();return new Date(a).toLocaleDateString("en-GB")}},{accessorKey:"expiryDate",header:()=>t.jsx("span",{title:"Expiry Date",children:"Ex"}),cell:e=>{const a=e.getValue();return new Date(a).toLocaleDateString("en-GB")}},{accessorKey:"costPrice",header:()=>t.jsx("span",{title:"Cost Price",children:"C.Price"}),cell:e=>e.getValue()},{accessorKey:"status",header:"Status",cell:({row:e})=>{const a=e.original.status,s=()=>{P({id:e.original._id,status:a==="active"?"inactive":"active"})};return t.jsx("span",{onClick:s,className:`cursor-pointer px-3 py-1 rounded-full text-sm font-semibold ${a==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a==="active"?"Active":"Inactive"})}},{header:"Actions",cell:({row:e})=>{const a=e.original.isBlock;return t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>i(`/admin/product-page/${e.original._id}`),className:"text-blue-600",children:"Edit"}),t.jsx("button",{onClick:()=>v(e.original._id),className:"text-red-600",children:"Delete"}),t.jsx("button",{onClick:()=>D(e.original._id,a),className:`font-medium ${a?"text-green-600":"text-yellow-600"}`,children:a?"Unblock":"Block"})]})}}];return l.useEffect(()=>{k()},[d,c]),y?t.jsx(L,{}):t.jsxs(t.Fragment,{children:[f&&r.success("Product status updated"),S&&r.error(N),t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-2 mt-5",children:[t.jsx(A,{className:"h-6 w-6 text-blue-600"}),t.jsx("h2",{className:"text-lg font-bold",children:"Products"})]}),t.jsxs("div",{className:"flex gap-2 mt-5",children:[t.jsx("input",{type:"text",placeholder:"Search...",value:o,onChange:e=>m(e.target.value),className:"border px-3 py-1 rounded-md"}),t.jsx("button",{onClick:()=>i("/admin/product/add"),className:"bg-indigo-600 text-white px-4 py-2 rounded-md",children:"Add"})]})]}),t.jsx("div",{className:"mt-8 flow-root",children:t.jsx("div",{className:"overflow-x-auto sm:-mx-6 lg:-mx-8",children:t.jsx("div",{className:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8",children:t.jsx(Q,{data:x,columns:C,enableSorting:!0,onPaginationChange:g,enableGlobalFilter:!0,onGlobalFilterChange:o,initialPagination:n,totalPages:(p=c==null?void 0:c.pagination)==null?void 0:p.totalPages})})})})]})};export{W as default};
