import{u as M,r as t,n as U,o as _,p as G,q as I,j as e}from"./index-Cl1SQMCp.js";import{L as V}from"./Loader-BikfMRdt.js";import{T as $}from"./TableData-CyOfLgzd.js";import{u as z}from"./useDebounce-CfTSEcaX.js";import{t as o}from"./index-MnOYjBE-.js";import{T as h}from"./toast-DZZ6LTTs.js";import{B as q}from"./briefcase-ChOFTStc.js";import"./index-BPJnJB5S.js";import"./CustomerHistory-BGs4THpq.js";import"./card-mR9xUq05.js";import"./badge-Duqbj1_E.js";import"./emailSendReceipt.api-LrsuY_7X.js";import"./label-DJCwXsjE.js";import"./zod-Cx2om5l9.js";import"./InstallmentAccordion-D9aMCyou.js";import"./index-7vMckiJz.js";import"./chevron-down-CZWChAHx.js";import"./index-zu5Pjoey.js";const me=()=>{var y;const l=M(),[n,b]=t.useState(""),[r,C]=t.useState({pageIndex:0,pageSize:10}),j=z(n,500),[k,S]=t.useState([]),{data:i,isLoading:v,isSuccess:m,refetch:N}=U({searchQuery:j.toLowerCase(),page:r.pageIndex+1,limit:r.pageSize}),[E,{isSuccess:u,isError:d,isLoading:p}]=_(),[B,{isSuccess:g,isError:f,isLoading:x}]=G(),[D,{data:L,error:w,isSuccess:P,isError:T}]=I(),F=async()=>{m&&S(i.result)},Q=async s=>{await B(s)},A=async(s,a)=>{try{const c=await E(s);console.log(a?"Company unblocked":"Company blocked",c),await N()}catch(c){console.error("Failed to toggle company block status",c)}},K=[{accessorKey:"name",header:"Company Name",cell:s=>s.getValue()},{accessorKey:"mobile",header:"Phone Number",cell:s=>s.getValue()},{accessorKey:"address",header:"City",cell:s=>s.getValue()},{accessorKey:"status",header:"Status",cell:({row:s})=>{const a=s.original.status,c=()=>{D({id:s.original._id,status:a==="active"?"inactive":"active"})};return t.useEffect(()=>{u&&o.success("Company blocked successfully")},[u]),t.useEffect(()=>{g&&o.success("Company deleted successfully")},[g]),t.useEffect(()=>{d&&o.error(" Failed to block company")},[d]),t.useEffect(()=>{f&&o.error(" Company delete successfully")},[f]),t.useEffect(()=>{p&&o.info("Blocking company...")},[p]),t.useEffect(()=>{x&&o.info("Blocking company...")},[x]),e.jsx("span",{onClick:c,className:`cursor-pointer px-3 py-1 rounded-full text-sm font-semibold ${a==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a==="active"?"Active":"Inactive"})}},{header:"Actions",cell:({row:s})=>{const a=s.original.isBlock;return e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>l(`/admin/company-page/${s.original._id}`),className:"text-blue-600",children:"Edit"}),e.jsx("button",{onClick:()=>Q(s.original._id),className:"text-red-600",children:"Delete"}),e.jsx("button",{onClick:()=>A(s.original._id,a),className:`font-medium ${a?"text-green-600":"text-yellow-600"}`,children:a?"Unblock":"Block"})]})}}];return t.useEffect(()=>{F()},[m,i]),v?e.jsx(V,{}):e.jsxs(e.Fragment,{children:[P&&e.jsx(h,{type:"success",message:L}),T&&e.jsx(h,{type:"error",message:w}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2 mt-5",children:[e.jsx(q,{className:"h-6 w-6 text-blue-600"}),e.jsx("h2",{className:"text-lg font-bold",children:"Companies"})]}),e.jsxs("div",{className:"flex gap-2 mt-5",children:[e.jsx("input",{type:"text",placeholder:"Search...",value:n,onChange:s=>b(s.target.value),className:"border px-3 py-1 rounded-md"}),e.jsx("button",{onClick:()=>l("/admin/company/add"),className:"bg-indigo-600 text-white px-4 py-2 rounded-md",children:"Add"})]})]}),e.jsx("div",{className:"mt-8 flow-root",children:e.jsx("div",{className:"overflow-x-auto sm:-mx-6 lg:-mx-8",children:e.jsx("div",{className:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8",children:e.jsx($,{data:k,columns:K,enableSorting:!0,onPaginationChange:C,enableGlobalFilter:!0,onGlobalFilterChange:n,initialPagination:r,totalPages:(y=i==null?void 0:i.pagination)==null?void 0:y.totalPages})})})})]})};export{me as default};
