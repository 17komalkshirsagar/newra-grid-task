import{i as G,u as L,K as O,M as Q,E as R,n as V,N as q,r as j,j as e,I as n,B as A}from"./index-Cl1SQMCp.js";import{u as H,t as K,o as J,c as T,s as l,e as b}from"./zod-Cx2om5l9.js";import{t as y}from"./index-MnOYjBE-.js";import{L as c}from"./label-DJCwXsjE.js";import{C as W,a as X,b as Y,d as Z}from"./card-mR9xUq05.js";import{T as $}from"./textarea-G-lwuaAY.js";import{I as ee}from"./icons-DO8VyPGD.js";import"./leaf-DQch67_8.js";import"./briefcase-ChOFTStc.js";const se=J({name:l().min(1),category:b(["Pesticide","Seed","Fertilizer","Other"]),company:l().min(1),description:l().optional(),price:l().refine(t=>!isNaN(Number(t)),{message:"Price must be a valid number"}),stock:l().refine(t=>!isNaN(Number(t)),{message:"Stock must be a valid number"}),unit:b(["kg","liter","packet","unit"]).optional(),expiryDate:T.date(),supplier:l().optional(),status:b(["active","inactive","blocked"]).optional(),batchNumber:l().min(1,{message:"Batch number is required"}),costPrice:l().refine(t=>!isNaN(Number(t)),{message:"Cost price must be a valid number"}).optional(),mrp:l().refine(t=>!isNaN(Number(t)),{message:"MRP must be a valid number"}).optional(),sellingPrice:l().refine(t=>!isNaN(Number(t)),{message:"Selling price must be a valid number"}).optional(),manufactureDate:T.date().optional()}),te={name:"",category:"Pesticide",company:"",description:"",price:"",costPrice:"",sellingPrice:"",mrp:"",stock:"",unit:"kg",expiryDate:new Date,supplier:"",status:"active",batchNumber:""},ue=()=>{var w,C;const{id:t}=G(),N=L(),{register:a,handleSubmit:B,reset:v,setValue:d,formState:{errors:r}}=H({resolver:K(se),defaultValues:te}),[I,{isSuccess:f,isError:P}]=O(),[M,{isSuccess:S}]=Q(),{data:o}=R({}),{data:m}=V({}),{data:i,isLoading:_}=q(t??"",{skip:!t}),[U,k]=j.useState(0);console.log("currentStock::",U),j.useEffect(()=>{var s,u,p,x,h,F,g,D,E;t&&i&&m&&o&&(v({name:i.name,category:i.category,company:((s=i.company)==null?void 0:s._id)??"",description:i.description??"",price:((u=i.price)==null?void 0:u.toString())??"",costPrice:((p=i.costPrice)==null?void 0:p.toString())??"",sellingPrice:((x=i.sellingPrice)==null?void 0:x.toString())??"",mrp:((h=i.mrp)==null?void 0:h.toString())??"",stock:((F=i.stock)==null?void 0:F.toString())??"",unit:i.unit??"kg",expiryDate:((D=(g=i.expiryDate)==null?void 0:g.split)==null?void 0:D.call(g,"T")[0])??"",supplier:((E=i.supplier)==null?void 0:E._id)??"",status:i.status??"active",batchNumber:i.batchNumber??""}),k(Number(i.stock??0)))},[t,i,m,o,v]),j.useEffect(()=>{f&&(y.success("Product added successfully"),N("/admin/product-table"))},[f,N]),j.useEffect(()=>{S&&(y.success("Product updated successfully"),N("/admin/product-table"))},[S]),j.useEffect(()=>{P&&y.error("Failed to save product")},[P]);const z=s=>{var p,x,h;const u={...s,price:s.price.toString(),stock:s.stock.toString(),costPrice:(p=s.costPrice)==null?void 0:p.toString(),sellingPrice:(x=s.sellingPrice)==null?void 0:x.toString(),mrp:(h=s.mrp)==null?void 0:h.toString()};t?M({id:t,data:u}):I(u)};return e.jsx("div",{className:"max-w-3xl mx-auto py-8",children:e.jsxs(W,{children:[e.jsxs(X,{className:"flex items-center justify-center",children:[e.jsx(ee.package,{className:"h-10 w-10 mb-2 text-green-600"}),e.jsx(Y,{children:t?"Update Product":"Add Product"})]}),e.jsx(Z,{children:e.jsxs("form",{onSubmit:B(z),className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx(c,{htmlFor:"name",children:"Product Name"}),e.jsx(n,{id:"name",...a("name")}),r.name&&e.jsx("p",{className:"text-red-500 text-sm",children:r.name.message})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx(c,{htmlFor:"batchNumber",children:"Batch Number"}),e.jsx(n,{id:"batchNumber",...a("batchNumber")}),r.batchNumber&&e.jsx("p",{className:"text-red-500 text-sm",children:r.batchNumber.message})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx(c,{htmlFor:"category",children:"Category"}),e.jsxs("select",{id:"category",...a("category"),className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"Pesticide",children:"Pesticide"}),e.jsx("option",{value:"Seed",children:"Seed"}),e.jsx("option",{value:"Fertilizer",children:"Fertilizer"}),e.jsx("option",{value:"Other",children:"Other"})]}),r.category&&e.jsx("p",{className:"text-red-500 text-sm",children:r.category.message})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx(c,{htmlFor:"company",children:"Company"}),e.jsxs("select",{id:"company",...a("company"),className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"Select Company"}),(w=m==null?void 0:m.result)==null?void 0:w.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx(c,{htmlFor:"price",children:"Price"}),e.jsx(n,{id:"price",type:"number",...a("price"),onChange:s=>d("price",s.target.value)}),r.price&&e.jsx("p",{className:"text-red-500 text-sm",children:r.price.message})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx(c,{htmlFor:"stock",children:"Stock"}),e.jsx(n,{id:"stock",type:"number",...a("stock"),onChange:s=>{d("stock",s.target.value),k(Number(s.target.value))}}),r.stock&&e.jsx("p",{className:"text-red-500 text-sm",children:r.stock.message})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx(c,{htmlFor:"manufactureDate",children:"Manufacture Date"}),e.jsx(n,{id:"manufactureDate",type:"date",...a("manufactureDate")})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx(c,{htmlFor:"expiryDate",children:"Expiry Date"}),e.jsx(n,{id:"expiryDate",type:"date",...a("expiryDate")}),r.expiryDate&&e.jsx("p",{className:"text-red-500 text-sm",children:r.expiryDate.message})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx(c,{htmlFor:"unit",children:"Unit"}),e.jsxs("select",{id:"unit",...a("unit"),className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"kg",children:"kg"}),e.jsx("option",{value:"liter",children:"liter"}),e.jsx("option",{value:"packet",children:"packet"}),e.jsx("option",{value:"unit",children:"unit"})]})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx(c,{htmlFor:"mrp",children:"MRP"}),e.jsx(n,{id:"mrp",type:"number",...a("mrp"),onChange:s=>d("mrp",s.target.value)}),r.mrp&&e.jsx("p",{className:"text-red-500 text-sm",children:r.mrp.message})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx(c,{htmlFor:"costPrice",children:"Cost Price"}),e.jsx(n,{id:"costPrice",type:"number",...a("costPrice"),onChange:s=>d("costPrice",s.target.value)}),r.costPrice&&e.jsx("p",{className:"text-red-500 text-sm",children:r.costPrice.message})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx(c,{htmlFor:"sellingPrice",children:"Selling Price"}),e.jsx(n,{id:"sellingPrice",type:"number",...a("sellingPrice"),onChange:s=>d("sellingPrice",s.target.value)}),r.sellingPrice&&e.jsx("p",{className:"text-red-500 text-sm",children:r.sellingPrice.message})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"w-1/2",children:[e.jsx(c,{htmlFor:"supplier",children:"Supplier"}),e.jsxs("select",{id:"supplier",...a("supplier"),className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"Select Supplier"}),(C=o==null?void 0:o.result)==null?void 0:C.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]})]}),e.jsxs("div",{className:"w-1/2",children:[e.jsx(c,{htmlFor:"status",children:"Status"}),e.jsxs("select",{id:"status",...a("status"),className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"blocked",children:"Blocked"})]})]})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"description",children:"Description"}),e.jsx($,{id:"description",...a("description")})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(A,{className:"bg-red-600",type:"button",variant:"outline",onClick:()=>v(),children:"Cancel"}),e.jsx(A,{type:"submit",disabled:_,className:"bg-green-600",children:t?"Update":"Save"})]})]})})]})})};export{ue as default};
