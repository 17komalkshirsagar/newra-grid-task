import{u as T,r as i,a4 as Q,a5 as A,a6 as F,a7 as L,j as e}from"./index-Cl1SQMCp.js";import{L as M}from"./Loader-BikfMRdt.js";import{T as U}from"./TableData-CyOfLgzd.js";import{T as m}from"./toast-DZZ6LTTs.js";import{u as _}from"./useDebounce-CfTSEcaX.js";import{B as G}from"./briefcase-ChOFTStc.js";import"./index-BPJnJB5S.js";import"./CustomerHistory-BGs4THpq.js";import"./card-mR9xUq05.js";import"./badge-Duqbj1_E.js";import"./emailSendReceipt.api-LrsuY_7X.js";import"./label-DJCwXsjE.js";import"./zod-Cx2om5l9.js";import"./index-MnOYjBE-.js";import"./InstallmentAccordion-D9aMCyou.js";import"./index-7vMckiJz.js";import"./chevron-down-CZWChAHx.js";import"./index-zu5Pjoey.js";const re=()=>{var u;const n=T(),[l,p]=i.useState(""),g=_(l,500),[o,x]=i.useState({pageIndex:0,pageSize:10}),[h,y]=i.useState([]),{data:a,isLoading:b,isSuccess:c,refetch:d}=Q({searchQuery:g.toLowerCase(),page:o.pageIndex+1,limit:o.pageSize}),[v]=A(),[f]=F(),[j,{data:D,error:S,isSuccess:k,isError:N}]=L(),C=()=>{c&&y(a.result)},w=async t=>{await v(t),d()},B=async(t,s)=>{try{const r=await f(t);console.log(s?"Delivery unblocked":"Delivery blocked",r),await d()}catch(r){console.error("Failed to toggle delivery block status",r)}},E=[{accessorKey:"address",header:"Address",cell:t=>t.getValue()},{accessorKey:"status",header:"Status",cell:({row:t})=>{const s=t.original.status,r=()=>{const P=s==="Pending"?"Delivered":"Pending";j({id:t.original._id,data:{status:P}})};return e.jsx("span",{onClick:r,className:`cursor-pointer px-3 py-1 rounded-full text-sm font-semibold ${s==="Delivered"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s})}},{header:"Actions",cell:({row:t})=>{const s=t.original.isBlock;return e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>n(`/delivery-page/${t.original._id}`),className:"text-blue-600",children:"Edit"}),e.jsx("button",{onClick:()=>w(t.original._id),className:"text-red-600",children:"Delete"}),e.jsx("button",{onClick:()=>B(t.original._id,s),className:`font-medium ${s?"text-green-600":"text-yellow-600"}`,children:s?"Unblock":"Block"})]})}}];return i.useEffect(()=>{C()},[c,a]),b?e.jsx(M,{}):e.jsxs(e.Fragment,{children:[k&&e.jsx(m,{type:"success",message:D.message}),N&&e.jsx(m,{type:"error",message:S}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mt-5",children:[e.jsx(G,{className:"h-6 w-6 text-blue-600"}),e.jsx("h2",{className:"text-lg font-bold",children:"Deliveries"})]}),e.jsxs("div",{className:"flex gap-2 mt-5",children:[e.jsx("input",{type:"text",placeholder:"Search...",value:l,onChange:t=>p(t.target.value),className:"border px-3 py-1 rounded-md"}),e.jsx("button",{onClick:()=>n("/delivery/add"),className:"bg-indigo-600 text-white px-4 py-2 rounded-md",children:"Add"})]})]}),e.jsx("div",{className:"mt-8 flow-root",children:e.jsx("div",{className:"overflow-x-auto sm:-mx-6 lg:-mx-8",children:e.jsx("div",{className:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8",children:e.jsx(U,{data:h,columns:E,enableSorting:!0,onPaginationChange:x,enableGlobalFilter:!0,onGlobalFilterChange:l,initialPagination:o,totalPages:(u=a==null?void 0:a.pagination)==null?void 0:u.totalPages})})})})]})};export{re as default};
