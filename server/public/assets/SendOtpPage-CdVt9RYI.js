import{u as N,r as s,d as w,e as C,j as e,I as x,B as I}from"./index-Cl1SQMCp.js";import{u as V,t as L,o as F,s as h}from"./zod-Cx2om5l9.js";import{t}from"./index-MnOYjBE-.js";import{I as q}from"./icons-DO8VyPGD.js";import{C as B,a as M,b as D,d as H}from"./card-mR9xUq05.js";import"./leaf-DQch67_8.js";import"./briefcase-ChOFTStc.js";const R=F({identifier:h().min(5,"Enter a valid email or mobile"),otp:h().optional()}),K=()=>{var p,g;const i=N(),[r,P]=s.useState(!1),[T,O]=s.useState(""),[S,{isLoading:a,isSuccess:c,isError:l}]=w(),[j,{isLoading:n,isSuccess:f,isError:m}]=C(),{register:u,handleSubmit:y,formState:{errors:o}}=V({resolver:L(R)}),v=async d=>{try{await S({adminName:d.identifier}).unwrap(),P(!0),O(d.identifier)}catch{console.log("Failed to send OTP")}},E=async d=>{try{await j({adminName:T,otp:d.otp}).unwrap()}catch{console.log("Invalid OTP")}};return s.useEffect(()=>{f&&(t.success("OTP verified!"),i("/dashboard"))},[f,i]),s.useEffect(()=>{m&&t.error("OTP verification failed. Please try again.")},[m]),s.useEffect(()=>{a&&t.loading("Sending OTP...")},[a]),s.useEffect(()=>{n&&t.loading("Sending Verifying OTP...")},[n]),s.useEffect(()=>{c&&(t.success("OTP verified!"),i("/verify-otp"))},[c,i]),s.useEffect(()=>{l&&t.error("Failed to send OTP. Please try again.")},[l]),e.jsx("div",{className:"flex items-center justify-center h-screen bg-muted",children:e.jsxs(B,{className:"w-[400px]",children:[e.jsxs(M,{className:"flex flex-col items-center justify-center gap-2",children:[e.jsx(q.trees,{className:"h-10 w-20 text-green-400"}),e.jsx(D,{className:"text-center",children:"Login with OTP"})]}),e.jsx(H,{children:e.jsx("form",{onSubmit:y(r?E:v),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(x,{placeholder:"Enter Your Email ID",...u("identifier"),disabled:r}),o.identifier&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:(p=o.identifier.message)==null?void 0:p.toString()})]}),r&&e.jsxs("div",{children:[e.jsx(x,{placeholder:"Enter OTP",...u("otp",{required:"OTP is required",minLength:{value:4,message:"OTP must be at least 4 digits"}})}),o.otp&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:(g=o.otp.message)==null?void 0:g.toString()})]}),e.jsx(I,{type:"submit",className:"w-full bg-green-400",disabled:a||n,children:r?n?"Verifying...":"Verify OTP":a?"Sending OTP...":"Send OTP"})]})})})]})})};export{K as default};
