import{u as K,r as a,ap as Q,aq as T,ar as A,as as I,j as t}from"./index-Cl1SQMCp.js";import{t as l}from"./index-MnOYjBE-.js";import{T as L}from"./TableData-CyOfLgzd.js";import{L as U}from"./Loader-BikfMRdt.js";import{u as V}from"./useDebounce-CfTSEcaX.js";import{B as _}from"./briefcase-ChOFTStc.js";import"./CustomerHistory-BGs4THpq.js";import"./card-mR9xUq05.js";import"./badge-Duqbj1_E.js";import"./emailSendReceipt.api-LrsuY_7X.js";import"./label-DJCwXsjE.js";import"./zod-Cx2om5l9.js";import"./InstallmentAccordion-D9aMCyou.js";import"./index-7vMckiJz.js";import"./chevron-down-CZWChAHx.js";import"./index-BPJnJB5S.js";const le=()=>{var y;const n=K(),[c,h]=a.useState(""),b=V(c,500),[r,E]=a.useState({pageIndex:0,pageSize:10}),[j,S]=a.useState([]),{data:o,isLoading:k,isSuccess:u,refetch:i}=Q({searchQuery:b.toLowerCase(),page:r.pageIndex+1,limit:r.pageSize}),[v,{isSuccess:d,error:m}]=T(),[N,{isSuccess:p,error:g}]=A(),[B,{isSuccess:x,error:f}]=I(),C=()=>{u&&S(o.result)},F=async e=>{try{await v(e),l.success("Employee deleted successfully"),i()}catch{console.log("Failed to delete employee")}},D=async(e,s)=>{console.log("Is Blocked:",s);try{await N(e),i()}catch{l.error("Failed to toggle block status")}},w=async(e,s)=>{try{await B({id:e,data:{status:s==="active"?"inactive":"active"}}),i()}catch{console.log("Failed to update status")}};a.useEffect(()=>{d&&l.success("Employee deleted successfully")},[d]),a.useEffect(()=>{p&&l.success("Employee block/unblock successful")},[p]),a.useEffect(()=>{x&&l.success("Employee status updated")},[x]),a.useEffect(()=>{m&&l.error("Failed to delete employee")},[m]),a.useEffect(()=>{g&&l.error("Failed to update block status")},[g]),a.useEffect(()=>{f&&l.error("Failed to update status")},[f]);const P=[{accessorKey:"name",header:"Employee Name",cell:e=>e.getValue()},{accessorKey:"phone",header:"Phone",cell:e=>e.getValue()},{accessorKey:"email",header:"Email",cell:e=>e.getValue()},{accessorKey:"role",header:"Role",cell:e=>e.getValue()},{accessorKey:"status",header:"Status",cell:({row:e})=>{const s=e.original.status;return t.jsx("span",{onClick:()=>w(e.original._id,s),className:`cursor-pointer px-3 py-1 rounded-full text-sm font-semibold ${s==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s==="active"?"Active":"Inactive"})}},{header:"Actions",cell:({row:e})=>{const s=e.original.isBlock;return t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:()=>n(`/admin/employee-page/${e.original._id}`),className:"text-blue-600",children:"Edit"}),t.jsx("button",{onClick:()=>F(e.original._id),className:"text-red-600",children:"Delete"}),t.jsx("button",{onClick:()=>D(e.original._id,s),className:`font-medium ${s?"text-green-600":"text-yellow-600"}`,children:s?"Unblock":"Block"})]})}}];return a.useEffect(()=>{C()},[u,o]),k?t.jsx(U,{}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsxs("div",{className:"flex items-center space-x-2 mt-5",children:[t.jsx(_,{className:"h-6 w-6 text-blue-600"}),t.jsx("h2",{className:"text-lg font-bold",children:"Employees"})]}),t.jsxs("div",{className:"flex gap-2 mt-5",children:[t.jsx("input",{type:"text",placeholder:"Search...",value:c,onChange:e=>h(e.target.value),className:"border px-3 py-1 rounded-md"}),t.jsx("button",{onClick:()=>n("/admin/employee-page"),className:"bg-indigo-600 text-white px-4 py-2 rounded-md",children:"Add"})]})]}),t.jsx("div",{className:"mt-8 flow-root",children:t.jsx("div",{className:"overflow-x-auto sm:-mx-6 lg:-mx-8",children:t.jsx("div",{className:"inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8",children:t.jsx(L,{data:j,columns:P,enableSorting:!0,onPaginationChange:E,enableGlobalFilter:!0,onGlobalFilterChange:c,initialPagination:r,totalPages:(y=o==null?void 0:o.pagination)==null?void 0:y.totalPages})})})})]})};export{le as default};
